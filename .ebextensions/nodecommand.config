option_settings:
  aws:elasticbeanstalk:container:nodejs:
    NodeCommand: "npm run migrate --omit=dev && NODE_ENV=production tsx server/index.ts"
  aws:elasticbeanstalk:container:nodejs:staticfiles:
    /public: public
  aws:elasticbeanstalk:application:environment:
    NODE_ENV: production
    PORT: 8080
  aws:elasticbeanstalk:application:
    Application Healthcheck URL: /healthz

container_commands:
  01_generate_migrations:
    command: "node scripts/generate-migrations.js"
  02_install_node_dependencies:
    command: "npm ci --omit=dev"
  03_build:
    command: "npm run build"
